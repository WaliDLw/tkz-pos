%<------------------------------------------> 
\RequirePackage{tkz-tab} 
\usetikzlibrary{shapes.geometric}
 \def\Nplot{\left(C_f\right)}
\def\Nline{\left(\Delta\right)}
\def\plot{f}
\def\line{y}
%<------------------------------------------>
  \newcommand*{\tkzTabPos}[2][]{%
 \makeatletter
 \setkeys[TAB]{TL}{#1}%   
 \setcounter{tkz@cnt@lg}{\thetkz@cnt@line}%
 \stepcounter{tkz@cnt@line}%
 \setcounter{tkz@cnt@lgnext}{\thetkz@cnt@line}%
 \setcounter{tkz@cnt@cl}{1}%
 \setcounter{tkz@cnt@pair}{1}%
 \setcounter{tkz@cnt@impair}{1}%
 %help
 \ifTAB@TL@help
 %
 \foreach \x in {#2}
   {%
   \ifthenelse{\isodd{\value{tkz@cnt@cl}}}{%
   \path (N\thetkz@cnt@impair\thetkz@cnt@lg) --%
           node[draw,inner sep =1pt,midway,fill=yellow] {%
            \footnotesize Z\thetkz@cnt@impair\thetkz@cnt@lg}%
         (N\thetkz@cnt@impair\thetkz@cnt@lgnext);
         \stepcounter{tkz@cnt@impair}}{%   
   \path (M\thetkz@cnt@pair\thetkz@cnt@lg)--%
         node[draw,inner sep =1pt,midway,fill=yellow] {%
           \footnotesize S\thetkz@cnt@pair\thetkz@cnt@lg}%
         (M\thetkz@cnt@pair\thetkz@cnt@lgnext); 
   \stepcounter{tkz@cnt@pair}}%
   \stepcounter{tkz@cnt@cl}%
   }
   % 
 \else
%
 \ifTAB@tbs@color%
  \draw(T1\thetkz@cnt@lg) rectangle (T2\thetkz@cnt@line);%
 \fi
%begin foreach
\stepcounter{tkz@cnt@aw}
  \foreach \x/\tl/\tr in {#2}
%
   {
   % 
   \ifthenelse{\isodd{\value{tkz@cnt@cl}}}{%
     \path (N\thetkz@cnt@impair\thetkz@cnt@lg) --%
             coordinate[midway](Z\thetkz@cnt@impair\thetkz@cnt@lg)%
           (N\thetkz@cnt@impair\thetkz@cnt@lgnext); 
%  
\ifthenelse{\equal{\expandafter\stripspaces\expandafter{\x}}{z}}{%
%%%%%%
\draw[line width =\cmdTAB@tbs@lw ]
([xshift=-01cm]N\thetkz@cnt@impair\thetkz@cnt@lgnext)..
controls+(90:0.5)and+(235:1)
..
(N\thetkz@cnt@impair\thetkz@cnt@lg);
%
\draw[line width =\cmdTAB@tbs@lw ]
([xshift=01cm]N\thetkz@cnt@impair\thetkz@cnt@lgnext) 
..
controls+(90:0.5)and+(305:1)..
(N\thetkz@cnt@impair\thetkz@cnt@lg);  
\node[font=\scriptsize, text width=4em, minimum height = 5em, align = center
] at   ([yshift=-02pt]Z\thetkz@cnt@impair\thetkz@cnt@lg){ \vbox to 4em{\vfill\RL{
  $\Nplot$
\\
    يقطع $\Nline$ 
 \\
   في النقطة\\
\scalebox{0.65}{\ifTAB@VA@help\else\tl\fi}    
   %
               }}}; 
              }{%
     \ifthenelse{\equal{\expandafter\stripspaces\expandafter{\x}}{}}{}{
%
\ifthenelse{\equal{\expandafter\stripspaces\expandafter{\x}}{t}}
{
         \draw[line width = \cmdTAB@tbs@lw,t style]
              (N\thetkz@cnt@impair\thetkz@cnt@lg) -- %
              (N\thetkz@cnt@impair\thetkz@cnt@lgnext);
}{
              %
\ifthenelse{\equal{\expandafter\stripspaces\expandafter{\x}}{d}}
{
       \draw[line width =\cmdTAB@tbs@lw,double style]%
         ([yshift = -\cmdTAB@tbs@lw/2] N\thetkz@cnt@impair\thetkz@cnt@lg)--%
         ([yshift = \cmdTAB@tbs@lw/2] N\thetkz@cnt@impair\thetkz@cnt@lgnext);
}{ 
\path (N\thetkz@cnt@impair\thetkz@cnt@lg)-- 
             (N\thetkz@cnt@impair\thetkz@cnt@lgnext); 
 \node at (Z\thetkz@cnt@impair\thetkz@cnt@lg){$\x$};
} 
       }
       }
       }
%       
       \stepcounter{tkz@cnt@impair}%
     }{%
       \path(M\thetkz@cnt@pair\thetkz@cnt@lg)--%
             coordinate[midway](S\thetkz@cnt@pair\thetkz@cnt@lg)%
            (M\thetkz@cnt@pair\thetkz@cnt@lgnext);% 
%%%%%%            
       \ifthenelse{\equal{\expandafter\stripspaces\expandafter{\x}}{h}}{
       %
          \setcounter{tkz@cnt@clnext}{\thetkz@cnt@pair}%
          \stepcounter{tkz@cnt@clnext}%
          \pgfmathparse{\cmdTAB@TTS@doubledistance/2+\cmdTAB@tbs@lw}
          \global\let\tkz@deltax\pgfmathresult 
          \fill[h style]([xshift=\tkz@deltax,yshift=-\cmdTAB@tbs@lw/2]%
                                N\thetkz@cnt@pair\thetkz@cnt@lg) 
                          rectangle%
                       ([xshift=-\tkz@deltax,yshift=\cmdTAB@tbs@lw/2]%
                                N\thetkz@cnt@clnext\thetkz@cnt@lgnext);
}{%
       \ifthenelse{\equal{\expandafter\stripspaces\expandafter{\x}}{+}}
{
 \node[inner sep=0pt,, text width=5em, minimum height = 5em, align = center,font=\scriptsize] at ([yshift=8pt]S\thetkz@cnt@pair\thetkz@cnt@lg) {
 \vbox to 3em{\vfill 
 $\Nplot$ \\
 {فوق}        
         \\
         $\Nline$}};
}
        {   \ifthenelse{\equal{\expandafter\stripspaces\expandafter{\x}}{-}}
{\node[inner sep=0pt,, text width=5em, minimum height = 5em, align = center,font=\scriptsize] at ([yshift=8pt]S\thetkz@cnt@pair\thetkz@cnt@lg) {
 \vbox to 3em{\vfill
$\Nplot$ \\
 {تحت}        
        \\ $\Nline$}};}{        
           \node at (S\thetkz@cnt@pair\thetkz@cnt@lg) {$\x$}; 
          }}}%%%%%%%%%%%%%%%%%%%%%
         \stepcounter{tkz@cnt@pair}%
        }%
   \stepcounter{tkz@cnt@cl}%
   }% end foreach  
   \fi}
   %
%<------------------------